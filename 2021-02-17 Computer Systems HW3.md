4450:320 Computer Systems

Dr. S. Sastry

Homework # 3

Translating to Assembly



1. $$
    f = \frac {(g+i)*(h+j)}{(g-i)*(h-j)}
  $$

  Answer:

  ```assembly
  # Register mapping
  #	f -> $s0
  # g -> $s1
  #	h -> $s2
  #	i -> $s3
  #	j -> $s4
  
  add $t0, $s1, $s3
  add $t1, $s2, $s4
  sub $t2, $s1, $s3
  sub $t3, $s2, $s4
  mul $t0, $t0, $t1
  mul $t1, $t2, $t3
  div $s0, $t0, $t1
  ```

  

2. ```cpp
    if (i <= j) f = g + h; else f = g - h;
    ```

  Answer: 

```assembly
# Register mapping
# i -> $s0
# j -> $s1
# f -> $s2
# g -> $s3
# h -> $s4

slt $t0, $s1, $s0
beq $t0, $zero, L1
sub $s2, $s3, $s4
j EXIT
L1: 
add $s2, $s3, $s4
EXIT:
...
```

3. ```cpp
   while (save[i-1] == k && save[i+1] != k) i += 1;
   ```

  Answer:

  ```assembly
# Register mapping
# save -> $s0
# i    -> $s1
# k    -> $s2

L1:
subi $t0, $s1, 1
sll $t0, $t0, 2
lw $t1, $t0($s0)
bne $t1, $s2, LN
addi $t0, $s1, 1
sll $t0, $t0, 2
lw $t1, $t0($s0)
beq $t1, $s2, LN
addi $s1, $s1, 1
j L1
LN:
...
  ```



4. 

```cpp
int fact (int n) {
    if (n < 1) return n; // Assuming typo in original problem when it said return f
    else return n * fact(n - 1);
}
```

Answer:

  

1. Return f if condition
2. Return n*recursive call with n-1 otherwise
   1. Store n at stack pointer

```assembly
# Register mapping
# n -> $a0
# returned value -> $v0

LF:
slti $t1, $a0, 1
beq $t1, $zero, LN
add $v0, $t0, $zero
j $ra
LN:

subi $t2
j $ra
```



1. Write MIPS assembly code for the sequence generated by the following specification
    F(0) = 1;
    M(0) = 0;
    F(n) = n – M(F(n-1)) when n > 0
    M(n) = n – F(M(n-1)) when n > 0